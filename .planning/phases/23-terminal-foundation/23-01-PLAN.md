---
phase: 23-terminal-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - site/src/styles/global.css
  - site/src/components/Terminal.astro
  - site/src/pages/index.astro
autonomous: false

must_haves:
  truths:
    - "Terminal container renders with dark background and monospace font"
    - "Blinking cursor element animates with slow pulse (not harsh blink)"
    - "Terminal sticks in viewport during scroll through demo section"
    - "All four phases of demo text are present in DOM from page load"
    - "Screen readers can access all demo text immediately"
  artifacts:
    - path: "site/src/styles/global.css"
      provides: "Terminal CSS variables and styles"
      contains: "--terminal-green"
    - path: "site/src/components/Terminal.astro"
      provides: "Terminal container component"
      min_lines: 80
    - path: "site/src/pages/index.astro"
      provides: "Terminal integration between hero and prose"
      contains: "Terminal"
  key_links:
    - from: "site/src/components/Terminal.astro"
      to: "site/src/styles/global.css"
      via: "CSS custom properties"
      pattern: "var\\(--terminal"
    - from: "site/src/pages/index.astro"
      to: "site/src/components/Terminal.astro"
      via: "Astro component import"
      pattern: "import Terminal"
---

<objective>
Build the terminal foundation: a static, sticky terminal container with CRT-style visual effects and all demo text pre-loaded in the DOM for accessibility.

Purpose: Creates the visual shell for the demo widget - the "stage" where the animation will play in Phase 24.
Output: Terminal.astro component integrated into landing page, positioned after hero, before prose section.
</objective>

<execution_context>
@/Users/jem/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jem/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/23-terminal-foundation/23-CONTEXT.md
@.planning/phases/23-terminal-foundation/23-RESEARCH.md
@site/src/styles/global.css
@site/src/pages/index.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add terminal CSS variables and styles to global.css</name>
  <files>site/src/styles/global.css</files>
  <action>
Add terminal-specific CSS variables to the :root block:
- `--terminal-green: #33ff66` (primary text, match hero green)
- `--terminal-green-dim: #22aa44` (prompt prefix $/>)
- `--terminal-glow: rgba(51, 255, 102, 0.4)` (text-shadow glow)
- `--terminal-bg: #0a0a0a` (screen background)
- `--terminal-chrome: #1a1a1a` (window frame)

Add terminal component styles in a new "TERMINAL DEMO" section:
1. `.terminal-container` - position: relative, height: 400vh (scroll height for 4 phases)
2. `.terminal` - position: sticky, top: 2rem, max-width: 42rem, margin: 0 auto
3. `.terminal-chrome` - window frame with decorative witchy buttons (unicode stars/runes)
4. `.terminal-screen` - dark background, green text with text-shadow glow, position: relative
5. `.terminal-screen::after` - scanline overlay using repeating-linear-gradient (opacity 0.2-0.3)
6. `.terminal-content` - pre element for monospace text layout
7. `.terminal-line` - individual line styling with data-phase attribute
8. `.terminal-prompt` - styled in dim green (--terminal-green-dim)
9. `.terminal-cursor` - block cursor with slow pulse animation (2s, opacity fade)
10. `.terminal-indicators` - phase progress dots at bottom

Add @keyframes cursor-pulse (0%,100% opacity:1, 50% opacity:0.3)

Add @media (prefers-reduced-motion: reduce) block:
- Disable cursor animation
- Reduce scanline opacity
- Disable any transitions

Use existing font-family: var(--font-body) which is Geist Mono.
  </action>
  <verify>
Grep for `--terminal-green` in global.css confirms variables added.
Grep for `.terminal-cursor` confirms cursor styles present.
Grep for `cursor-pulse` confirms keyframes defined.
  </verify>
  <done>
Terminal CSS variables and all component styles exist in global.css, including reduced-motion support.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Terminal.astro component</name>
  <files>site/src/components/Terminal.astro</files>
  <action>
Create new Astro component with semantic HTML structure:

```astro
---
// Terminal.astro - Demo terminal widget
// All text in DOM from start for accessibility
---

<div class="terminal-container">
  <section class="terminal" aria-label="Esoterica demo">
    <!-- Witchy window chrome -->
    <div class="terminal-chrome" aria-hidden="true">
      <span class="terminal-btn">&#x2726;</span>
      <span class="terminal-btn">&#x2605;</span>
      <span class="terminal-btn">&#x273B;</span>
    </div>

    <!-- Terminal screen with all content pre-loaded -->
    <div class="terminal-screen" role="log" aria-live="polite" aria-atomic="false">
      <pre class="terminal-content">
        <!-- Phase 1: Ask question -->
        <span class="terminal-line" data-phase="1">
          <span class="terminal-prompt" aria-hidden="true">$</span>
          <span class="terminal-text">esoterica</span>
        </span>
        <!-- Phase 2: Pull cards -->
        <span class="terminal-line" data-phase="2">
          <span class="terminal-text">Drawing cards...</span>
        </span>
        <!-- Phase 3: Interpretation -->
        <span class="terminal-line" data-phase="3">
          <span class="terminal-text">The Tower speaks of transformation...</span>
        </span>
        <!-- Phase 4: Integration -->
        <span class="terminal-line" data-phase="4">
          <span class="terminal-text">Integrating insight into your workflow...</span>
        </span>
      </pre>
      <span class="terminal-cursor" aria-hidden="true"></span>
    </div>

    <!-- Phase progress indicators -->
    <nav class="terminal-indicators" aria-label="Demo progress">
      <span class="indicator active" aria-current="step" data-phase="1"></span>
      <span class="indicator" data-phase="2"></span>
      <span class="indicator" data-phase="3"></span>
      <span class="indicator" data-phase="4"></span>
    </nav>
  </section>
</div>
```

Key accessibility features:
- `role="log"` and `aria-live="polite"` on terminal-screen
- `aria-hidden="true"` on decorative elements (chrome, prompt symbols, cursor)
- `aria-label` on main section and nav
- All text physically in DOM from page load
- `data-phase` attributes for Phase 24 animation targeting

Note: Placeholder text for demo phases - real content comes in Phase 25.
  </action>
  <verify>
File exists at site/src/components/Terminal.astro.
Grep for `role="log"` confirms accessibility markup.
Grep for `data-phase` confirms phase targeting attributes present.
  </verify>
  <done>
Terminal.astro component created with semantic HTML, accessibility attributes, and all demo text in DOM.
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate Terminal into index.astro</name>
  <files>site/src/pages/index.astro</files>
  <action>
Modify index.astro to include the Terminal component:

1. Add import at top of frontmatter:
   `import Terminal from '../components/Terminal.astro';`

2. Insert Terminal component after hero div, before prose section (around line 89-91):
   ```astro
   </div>  <!-- end .hero -->

   <!-- Demo Terminal -->
   <Terminal />

   <!-- Prose Section -->
   <section class="prose">
   ```

The terminal-container's 400vh height creates the scroll space.
The sticky terminal stays in viewport while user scrolls through phases.
Position after hero maintains "early visibility" per CONTEXT.md.
  </action>
  <verify>
Run `npm run dev` in site/ directory and visit http://localhost:4321/esoterica/.
Terminal appears below hero, sticks during scroll.
All demo text visible in View Source (pre-loaded in DOM).
  </verify>
  <done>
Terminal component integrated into landing page, positioned after hero, with 400vh scroll container.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Terminal foundation with CRT visual effects:
- Dark terminal container with witchy window chrome (unicode stars)
- Green-on-black text with glow effect
- Scanline overlay for CRT aesthetic
- Blinking cursor with slow pulse animation
- Sticky scroll behavior (terminal stays in view during 400vh scroll)
- All demo text pre-loaded in DOM
- Phase progress indicator dots
  </what-built>
  <how-to-verify>
1. Visit http://localhost:4321/esoterica/ (run `npm run dev` in site/ if needed)
2. Scroll past hero section - terminal should appear
3. Continue scrolling - terminal should stick in upper viewport
4. Verify visual elements:
   - Green text on dark background
   - Subtle text glow
   - Scanline effect (subtle, not overwhelming)
   - Pulsing cursor (smooth, not harsh blink)
   - Witchy unicode buttons in window chrome
5. Right-click > View Page Source - confirm all demo text is in HTML
6. Test reduced motion: In Chrome DevTools > Rendering > Emulate prefers-reduced-motion: reduce
   - Cursor should stop animating
   - Scanlines should be dimmer
7. Check terminal width - should be narrow/focused, not full-width
  </how-to-verify>
  <resume-signal>Type "approved" or describe any visual/functional issues to address</resume-signal>
</task>

</tasks>

<verification>
Phase 23 success criteria from v1.5-ROADMAP.md:
1. Terminal container renders with dark background, border styling, and monospace font
2. Blinking cursor element animates in the terminal
3. Terminal container sticks in viewport during scroll through demo section
4. All four phases of demo text are present in the DOM from page load (screen reader accessible)
</verification>

<success_criteria>
- Terminal.astro component exists with semantic HTML and ARIA attributes
- Terminal CSS variables defined in global.css
- Cursor pulse animation runs at 2s duration
- Terminal sticks during 400vh scroll
- View Source shows all demo text (not injected by JS)
- Reduced-motion users see static cursor and dimmed scanlines
</success_criteria>

<output>
After completion, create `.planning/phases/23-terminal-foundation/23-01-SUMMARY.md`
</output>
