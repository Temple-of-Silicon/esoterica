---
phase: 12-visual-language
plan: 03
type: execute
wave: 3
depends_on: ["12-02"]
files_modified:
  - brand/social/og-image.png
  - brand/social/linkedin.png
  - brand/social/twitter.png
  - brand/social/instagram-square.png
  - brand/social/instagram-story.png
  - brand/favicon/favicon.svg
  - brand/favicon/favicon-16x16.png
  - brand/favicon/favicon-32x32.png
  - brand/favicon/apple-touch-icon.png
autonomous: true

must_haves:
  truths:
    - "Social media images exist in all required formats and sizes"
    - "Favicon is recognizable at 16x16 and 32x32 pixels"
    - "All assets derive from hero winner for visual consistency"
  artifacts:
    - path: "brand/social/"
      provides: "All social media image variants"
    - path: "brand/favicon/favicon.svg"
      provides: "Vector favicon source"
    - path: "brand/favicon/favicon-32x32.png"
      provides: "Browser tab favicon"
  key_links:
    - from: "brand/hero/winners/hero-primary.png"
      to: "brand/social/"
      via: "Sharp resize/crop"
      pattern: "sharp.*resize"
---

<objective>
Generate social media asset variants and favicon from the selected hero image.

Purpose: Consistent visuals across all platforms require properly sized and cropped versions. Favicon provides brand recognition in browser tabs.

Output: Complete social media kit (5 sizes) and favicon set (SVG + 3 PNG sizes) ready for landing page and social profiles.
</objective>

<execution_context>
@/Users/jem/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jem/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/12-visual-language/12-CONTEXT.md
@.planning/phases/12-visual-language/12-RESEARCH.md
@.planning/phases/12-visual-language/12-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Generate social media asset variants</name>
  <files>
    brand/social/og-image.png
    brand/social/linkedin.png
    brand/social/twitter.png
    brand/social/instagram-square.png
    brand/social/instagram-story.png
  </files>
  <action>
Create a Sharp-based script to generate all social media variants from the hero winner.

**Create brand/scripts/generate-social-assets.ts:**

```typescript
import sharp from "sharp";
import path from "path";
import { fileURLToPath } from "url";

const __dirname = path.dirname(fileURLToPath(import.meta.url));

interface SocialVariant {
  name: string;
  width: number;
  height: number;
}

const SOCIAL_VARIANTS: SocialVariant[] = [
  { name: "og-image", width: 1200, height: 630 },      // Open Graph
  { name: "linkedin", width: 1200, height: 627 },      // LinkedIn
  { name: "twitter", width: 1200, height: 675 },       // Twitter/X
  { name: "instagram-square", width: 1080, height: 1080 }, // Instagram feed
  { name: "instagram-story", width: 1080, height: 1920 },  // Instagram stories
];

async function generateSocialAssets() {
  const heroPath = path.join(__dirname, "../hero/winners/hero-primary.png");
  const outputDir = path.join(__dirname, "../social");

  console.log(`Processing hero image: ${heroPath}`);

  for (const variant of SOCIAL_VARIANTS) {
    const outputPath = path.join(outputDir, `${variant.name}.png`);

    await sharp(heroPath)
      .resize(variant.width, variant.height, {
        fit: "cover",
        position: "attention", // Smart crop focusing on important areas
      })
      .png({ quality: 90, compressionLevel: 9 })
      .toFile(outputPath);

    console.log(`Generated: ${variant.name} (${variant.width}x${variant.height})`);
  }

  console.log("\\nAll social assets generated!");
}

generateSocialAssets().catch(console.error);
```

**Run the script:**
```bash
cd brand && npx tsx scripts/generate-social-assets.ts
```

**Verify each output:**
- Check that instagram-square (1:1) and instagram-story (9:16) crops retain the altar/cards focal point
- If crops are awkward, consider:
  - Using position: "center" instead of "attention"
  - Generating dedicated portrait composition via generate-image skill for stories

**Note:** If 16:9 hero crops poorly to 9:16 story format, flag for potential dedicated vertical generation in summary.
  </action>
  <verify>
    - `ls brand/social/*.png | wc -l` returns 5
    - `file brand/social/og-image.png | grep "1200 x 630"` confirms dimensions
    - `file brand/social/instagram-square.png | grep "1080 x 1080"` confirms dimensions
  </verify>
  <done>All 5 social media variants generated with smart cropping from hero image</done>
</task>

<task type="auto">
  <name>Task 2: Create favicon</name>
  <files>
    brand/favicon/favicon.svg
    brand/favicon/favicon-16x16.png
    brand/favicon/favicon-32x32.png
    brand/favicon/apple-touch-icon.png
  </files>
  <action>
Create a simplified tarot card motif favicon that's recognizable at small sizes.

**Design approach (per CONTEXT.md):**
- Tarot card shape: simplified rectangle with rounded corners
- Motif: stylized star or mystical symbol (not detailed imagery)
- Colors: extract primary from hero image, use for accent
- Must be legible at 16x16 pixels (extreme simplification required)

**Option A - Generate via Replicate:**
Use generate-image skill with square aspect ratio and simplified prompt:
```
Minimalist tarot card icon, single mystical symbol, selenite crystal texture, eco-futurist aesthetic, simple geometric, clean lines, vector style, on transparent background
```

**Option B - Create SVG manually (recommended for control):**
Create brand/favicon/favicon.svg:
```svg
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <!-- Tarot card shape -->
  <rect x="6" y="2" width="20" height="28" rx="2" fill="#1a1a2e" stroke="#c9a87c" stroke-width="1.5"/>
  <!-- Mystical star/symbol -->
  <path d="M16 8 L18 14 L24 14 L19 18 L21 24 L16 20 L11 24 L13 18 L8 14 L14 14 Z" fill="#c9a87c"/>
</svg>
```

Colors (#1a1a2e deep mystical blue, #c9a87c warm gold) are placeholders - extract actual colors from hero after palette extraction or use these as defaults.

**Generate PNG variants with Sharp:**
```typescript
import sharp from "sharp";
import { promises as fs } from "fs";

async function generateFavicons() {
  const svgPath = "brand/favicon/favicon.svg";
  const svgBuffer = await fs.readFile(svgPath);

  const sizes = [
    { size: 16, name: "favicon-16x16.png" },
    { size: 32, name: "favicon-32x32.png" },
    { size: 180, name: "apple-touch-icon.png" },
  ];

  for (const { size, name } of sizes) {
    await sharp(svgBuffer)
      .resize(size, size, { fit: "contain", background: { r: 0, g: 0, b: 0, alpha: 0 } })
      .png({ quality: 100, compressionLevel: 9 })
      .toFile(`brand/favicon/${name}`);

    console.log(`Generated: ${name} (${size}x${size})`);
  }
}

generateFavicons().catch(console.error);
```

**Test at actual sizes:**
- Open favicon-16x16.png and favicon-32x32.png at 100% zoom
- Confirm the card shape and star symbol are distinguishable
- If muddy, simplify further (remove star, use solid card with edge highlight)
  </action>
  <verify>
    - `ls brand/favicon/` shows favicon.svg, favicon-16x16.png, favicon-32x32.png, apple-touch-icon.png
    - `file brand/favicon/favicon-32x32.png | grep "32 x 32"` confirms dimensions
    - `file brand/favicon/apple-touch-icon.png | grep "180 x 180"` confirms dimensions
  </verify>
  <done>Favicon set created with SVG source and PNG variants for all browser contexts</done>
</task>

</tasks>

<verification>
Complete asset verification:
1. Social assets: `for f in brand/social/*.png; do echo "$f: $(file "$f" | grep -o '[0-9]* x [0-9]*')"; done`
2. Favicon: `for f in brand/favicon/*.png; do echo "$f: $(file "$f" | grep -o '[0-9]* x [0-9]*')"; done`
3. Visual check: Open brand/social/ and brand/favicon/ in image viewer to confirm quality
</verification>

<success_criteria>
- 5 social media variants exist with correct dimensions
- Favicon SVG exists as source
- 3 favicon PNGs exist (16x16, 32x32, 180x180)
- Instagram story format doesn't lose critical composition (or noted in summary for dedicated generation)
- Favicon is recognizable in browser tabs
</success_criteria>

<output>
After completion, create `.planning/phases/12-visual-language/12-03-SUMMARY.md`
</output>
