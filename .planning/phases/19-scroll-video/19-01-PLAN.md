---
phase: 19-scroll-video
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - site/public/video/hero.mp4
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "Source video is compressed from ~25MB to under 5MB"
    - "Compressed video is h264+AAC in MP4 container for broad browser support"
    - "Video plays correctly when opened directly"
    - "Video directory is gitignored (build artifact)"
  artifacts:
    - path: "site/public/video/hero.mp4"
      provides: "Compressed hero video for scroll-driven playback"
  key_links: []
---

<objective>
Compress the source MP4 video with ffmpeg for web delivery.

Purpose: The 25MB source video is too large for web. Compress to ~3-5MB using h264 CRF encoding while maintaining visual quality at 1920px width. The scroll scrubber component (Plan 02) will use this file directly as a `<video>` element source.

Output: Compressed `hero.mp4` in `site/public/video/`, gitignored as a build artifact.
</objective>

<context>
Source video: /Users/jem/Downloads/weavy-Kling First & Last Frame-2026-01-28 at 11.59.12.mp4
- 1928x1072 resolution, h264, 24fps, 10.08 seconds, ~25MB (20288 kb/s)
- ffmpeg is installed at /opt/homebrew/bin/ffmpeg
</context>

<tasks>

<task type="auto">
  <name>Task 1: Compress video with ffmpeg</name>
  <files>site/public/video/hero.mp4, .gitignore</files>
  <action>
1. Create the output directory: `site/public/video/`

2. Compress with ffmpeg using CRF encoding:
```bash
ffmpeg -i "/Users/jem/Downloads/weavy-Kling First & Last Frame-2026-01-28 at 11.59.12.mp4" \
  -vf "scale=1920:-2" \
  -c:v libx264 -crf 28 -preset slow \
  -profile:v main -level 4.0 \
  -movflags +faststart \
  -an \
  "site/public/video/hero.mp4"
```

Key parameters:
- `scale=1920:-2`: Scale width to 1920px, auto height (even number)
- `-c:v libx264 -crf 28`: Constant quality encoding, CRF 28 gives good quality at small size
- `-preset slow`: Better compression ratio (worth the encode time)
- `-profile:v main -level 4.0`: Broad browser/device compatibility
- `-movflags +faststart`: Move moov atom to front for instant web playback
- `-an`: Strip audio (not needed for scroll-driven playback)

3. Verify output:
   - Check file size (target: under 5MB)
   - If over 5MB, re-encode with CRF 32
   - Verify it plays: `ffprobe site/public/video/hero.mp4`

4. Add `site/public/video/` to `.gitignore` â€” these are build artifacts that will be stored in CDN/LFS later.
  </action>
  <verify>
- `ls -lh site/public/video/hero.mp4` shows file under 5MB
- `ffprobe site/public/video/hero.mp4 2>&1 | grep Stream` confirms h264 video, no audio
- `.gitignore` contains `site/public/video/`
  </verify>
  <done>
Source video compressed from ~25MB to under 5MB. h264 MP4 with faststart flag for instant web playback. No audio track. Video directory gitignored.
  </done>
</task>

</tasks>

<verification>
- Compressed video exists and is under 5MB
- Video is h264 MP4 with faststart
- No audio track (stripped)
- site/public/video/ is in .gitignore
</verification>

<success_criteria>
Compressed hero video ready for the scroll scrubber component. Small enough for web delivery, compatible across browsers, with faststart for instant playback.
</success_criteria>

<output>
After completion, create `.planning/phases/19-scroll-video/19-01-SUMMARY.md`
</output>
