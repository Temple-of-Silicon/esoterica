---
phase: 05-polish-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: ["~/.claude/skills/tarot/SKILL.md"]
autonomous: false

must_haves:
  truths:
    - "Claude can autonomously invoke /tarot when contextually appropriate"
    - "Output length adapts to user context depth"
    - "Readings echo user's specific situation back to them"
    - "Readings end with reflective questions specific to user's context"
  artifacts:
    - path: "~/.claude/skills/tarot/SKILL.md"
      provides: "Polished tarot skill with self-invocation and output formatting"
      contains: "description: Perform a single-card tarot reading"
  key_links:
    - from: "SKILL.md frontmatter"
      to: "Claude skill invocation"
      via: "no disable-model-invocation flag"
      pattern: "^---[\\s\\S]*?---"
    - from: "Reading Instructions"
      to: "Output format"
      via: "adaptive length, context echo, reflective closing"
      pattern: "assess context depth|Echo their specific situation|End with reflection"
---

<objective>
Polish the tarot skill for smooth invocation by both users and Claude, with adaptive output formatting.

Purpose: Complete INVOKE-01 and INVOKE-02 requirements. User invocation already works; this plan enables Claude self-invocation and adds output polish (adaptive length, context echoing, reflective closing).

Output: Updated SKILL.md with invocation control changes and improved Reading Instructions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-polish-integration/05-RESEARCH.md
@.planning/phases/05-polish-integration/05-CONTEXT.md
@~/.claude/skills/tarot/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enable Claude self-invocation</name>
  <files>~/.claude/skills/tarot/SKILL.md</files>
  <action>
Modify SKILL.md frontmatter to enable Claude self-invocation:

1. REMOVE the line `disable-model-invocation: true` from frontmatter
   - This allows Claude to invoke /tarot when contextually appropriate
   - Tarot has no side effects, so self-invocation is safe

2. UPDATE the description field to include trigger keywords:
   - Change from: `description: Perform a single-card tarot reading with random Major Arcana selection`
   - Change to: `description: Perform a single-card tarot reading with random Major Arcana selection. Use when seeking perspective on decisions, feeling stuck, exploring options, or when the user asks for a tarot reading or card draw.`
   - These keywords help Claude recognize when to invoke autonomously

3. ADD a maintainer comment after the frontmatter (before # Tarot Reading Skill):
```markdown
<!--
SKILL MAINTAINER NOTES
======================
Invocation: Both user (/tarot) and Claude can invoke this skill.
Voice selection: --voice flag > .tarot file > ~/.claude/tarot/config > default (grounded)
Config format: voice=mystic or voice=grounded (one line, no quotes)

Design decisions:
- Context fork prevents reading bleed into main conversation
- Shell injection for randomness (shuf), config reading (grep/cut)
- Embedded card data for portability (no external files)
- Voice is lens not persona (same cards, different framing)

Last updated: Phase 5 polish
-->
```

Do NOT change any other content in this task - output formatting is Task 2.
  </action>
  <verify>
Verify frontmatter changes:
- `grep -c "disable-model-invocation" ~/.claude/skills/tarot/SKILL.md` returns 0
- `grep "description:" ~/.claude/skills/tarot/SKILL.md` includes "seeking perspective" and "feeling stuck"
- `grep -c "SKILL MAINTAINER NOTES" ~/.claude/skills/tarot/SKILL.md` returns 1
  </verify>
  <done>
- SKILL.md frontmatter no longer has disable-model-invocation: true
- Description includes trigger keywords for autonomous invocation
- Maintainer documentation added as HTML comment
  </done>
</task>

<task type="auto">
  <name>Task 2: Add output format polish to Reading Instructions</name>
  <files>~/.claude/skills/tarot/SKILL.md</files>
  <action>
Update the "Reading Instructions" section to add:

1. ADAPTIVE LENGTH DETECTION - Add as new step 1 (renumber existing steps):
```markdown
1. **Assess context depth** - Before interpreting, check the **Question/Context** field:
   - **Quick draw** (0-1 sentences, generic request like "draw a card"): 2 paragraphs, ~150-200 words
   - **Standard draw** (2-3 sentences with some specifics): 3 paragraphs, ~250-300 words
   - **Deep draw** (4+ sentences, rich context): 4 paragraphs, ~350-400 words

   Adapt length to match user's investment. Maintain voice at all depths.
```

2. CONTEXT ECHOING - Modify existing "Connect card to context" step:
```markdown
2. **Connect card to context with echo** - If the querent asked a question, interpret the card through that lens. Echo their specific situation back to them:

   **Good:** "You mentioned feeling stuck in your authentication refactor - The Tower suggests this isn't theoretical..."

   **Avoid:** "The Tower is about sudden change and destruction of false structures..."

   The echo shows you heard them and are reading FOR them, not AT them. Use their actual words where possible.
```

3. REFLECTIVE CLOSING - Add to structure guidance at the end:
```markdown
**End with a specific reflective question:**
- NOT generic: "What will you do?" or "How does this resonate?"
- SPECIFIC to their context and the card drawn:
  - Mystic: "What truth might emerge if you release your grip on [specific thing from their context]?"
  - Grounded: "What's the minimum viable [solution to their problem] you could implement before the breakdown happens?"
```

4. UPDATE the structure template to include the reflective question explicitly:
```markdown
**Structure your reading as:**

[Voice-appropriate opening bookend]

**[Card Name]** (with simple decorative border if mystic voice)

[Context echo - reference their specific situation if provided]

[Core interpretation - what this card means for them right now]

[Shadow consideration if relevant]

[Voice-appropriate closing with SPECIFIC reflective question tailored to their context]
```

5. ADD visual card header examples in the structure:
```markdown
<!-- Card header formatting -->
<!-- Mystic voice: **=== The Tower ===** -->
<!-- Grounded voice: **--- The Tower ---** -->
```
  </action>
  <verify>
Verify Reading Instructions updated:
- `grep -c "Assess context depth" ~/.claude/skills/tarot/SKILL.md` returns 1
- `grep -c "Quick draw" ~/.claude/skills/tarot/SKILL.md` returns 1
- `grep -c "Echo their specific situation" ~/.claude/skills/tarot/SKILL.md` returns 1
- `grep -c "specific reflective question" ~/.claude/skills/tarot/SKILL.md` returns 1
  </verify>
  <done>
- Reading Instructions include adaptive length detection (quick/standard/deep draw)
- Context echoing instructions added with good/avoid examples
- Reflective closing question guidance added with voice-specific examples
- Structure template updated to include echo and specific question
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete skill polish: Claude self-invocation enabled, adaptive output formatting added.
  </what-built>
  <how-to-verify>
1. **Test Claude self-invocation understanding:**
   - In a fresh conversation, describe being stuck on a decision
   - See if Claude recognizes it could offer a tarot reading
   - (Note: Claude may not always invoke, but should know it CAN)

2. **Test adaptive length - quick draw:**
   - `/tarot`
   - Should get ~2 paragraphs, brief reading

3. **Test adaptive length - deep draw:**
   - `/tarot I'm stuck on whether to refactor our authentication system. The current JWT implementation has no signature verification, weak secret management, and we have a security audit in 3 months. I've been putting it off because it feels overwhelming. --voice grounded`
   - Should get ~4 paragraphs, deeper reading
   - Should echo your specific auth situation
   - Should end with specific reflective question about auth/deadline

4. **Verify context echo:**
   - Reading should reference "authentication", "JWT", "security audit" - your actual words

5. **Verify reflective question:**
   - Should NOT be generic "How does this resonate?"
   - SHOULD be specific like "What's the minimum viable auth fix before the audit?"
  </how-to-verify>
  <resume-signal>Type "approved" if readings show adaptive length, context echo, and specific reflective questions. Otherwise describe what's missing.</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:
- [ ] `disable-model-invocation` removed from frontmatter
- [ ] Description includes trigger keywords
- [ ] Maintainer comments present
- [ ] Adaptive length instructions present
- [ ] Context echo instructions present
- [ ] Reflective question instructions present
- [ ] User-verified readings show polish improvements
</verification>

<success_criteria>
- INVOKE-02 satisfied: Claude can invoke tarot when stuck/exploring (flag removed, triggers in description)
- INVOKE-01 polished: User invocation produces adaptive, context-aware readings
- Output format: Readings echo user context, adapt length, end with specific questions
- User confirms readings feel more personalized and contextually relevant
</success_criteria>

<output>
After completion, create `.planning/phases/05-polish-integration/05-01-SUMMARY.md`
</output>
