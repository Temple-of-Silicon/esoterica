---
phase: 01-skill-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ~/.claude/skills/tarot/SKILL.md
autonomous: true

must_haves:
  truths:
    - "User can run /tarot and receive a response"
    - "Response includes a randomly selected card number (0-21)"
    - "Response comes from an isolated subagent context"
  artifacts:
    - path: "~/.claude/skills/tarot/SKILL.md"
      provides: "Tarot skill with context fork and random card selection"
      min_lines: 30
  key_links:
    - from: "/tarot command"
      to: "SKILL.md"
      via: "Claude Code skill invocation"
      pattern: "name: tarot"
    - from: "SKILL.md"
      to: "subagent"
      via: "context: fork frontmatter"
      pattern: "context: fork"
    - from: "SKILL.md"
      to: "random card"
      via: "shell injection"
      pattern: "shuf -i 0-21 -n 1"
---

<objective>
Create the `/tarot` skill that spawns an isolated subagent for tarot readings with random card selection.

Purpose: Establish the core invocation infrastructure so subsequent phases can add card meanings and voice system.

Output: Working `/tarot` command that selects a random Major Arcana card (0-21) and provides basic interpretation via forked subagent context.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-skill-infrastructure/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create tarot skill directory and SKILL.md</name>
  <files>~/.claude/skills/tarot/SKILL.md</files>
  <action>
Create the skill directory and SKILL.md file:

1. Create directory: `mkdir -p ~/.claude/skills/tarot`

2. Create SKILL.md with the following structure:

**Frontmatter (YAML):**
- `name: tarot`
- `description: Perform a single-card tarot reading with random Major Arcana selection`
- `disable-model-invocation: true` (prevents auto-triggering when "tarot" mentioned)
- `context: fork` (spawns isolated subagent)
- `agent: general-purpose` (uses default Claude subagent)

**Content:**
- Random card selection using shell injection: `!`shuf -i 0-21 -n 1``
- Basic tarot-reader persona prompt
- Two voice placeholders (Mystic and Grounded) - detailed implementation in Phase 3
- Simple interpretation instructions
- Output format specification

**Important:**
- Card range is 0-21 (The Fool is 0, The World is 21) - NOT 1-22
- Use backtick syntax for shell injection: exclamation mark followed by backtick-command-backtick
- Keep file under 500 lines (this will be ~50 lines for Phase 1)
- Include basic card number-to-name mapping (will be expanded in Phase 2)

Reference the research document for exact syntax patterns.
  </action>
  <verify>
- File exists: `ls -la ~/.claude/skills/tarot/SKILL.md`
- Frontmatter valid: `head -10 ~/.claude/skills/tarot/SKILL.md` shows correct YAML
- Shell injection present: `grep "shuf -i 0-21" ~/.claude/skills/tarot/SKILL.md`
- Context fork present: `grep "context: fork" ~/.claude/skills/tarot/SKILL.md`
  </verify>
  <done>
SKILL.md exists with correct frontmatter (name, description, disable-model-invocation, context: fork, agent) and shell injection for random card 0-21.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify /tarot command works</name>
  <what-built>
The `/tarot` skill with:
- Random Major Arcana card selection (0-21)
- Forked subagent context for isolated interpretation
- Basic interpretation output with card number and name
  </what-built>
  <how-to-verify>
1. Open a new Claude Code session (or use current)
2. Run `/tarot`
3. Verify:
   - Command executes without error
   - Response includes a card number between 0-21
   - Response includes the card name (e.g., "The Fool", "The Magician")
   - Response provides some interpretation text
   - Response comes from subagent (should see Task tool usage in verbose mode)

4. Run `/tarot` again to verify randomness:
   - Should get a different card (probability ~95% different)
   - Format should be consistent
  </how-to-verify>
  <resume-signal>Type "approved" if /tarot works and returns card interpretations, or describe what's broken</resume-signal>
</task>

</tasks>

<verification>
Phase 1 complete when:
- `/tarot` command is recognized by Claude Code
- Command spawns a subagent (context isolation)
- Random card number 0-21 is selected via bash shuf
- Basic interpretation is returned
- Multiple invocations show different cards (randomness works)
</verification>

<success_criteria>
- SKILL-01: `/tarot` skill invokes tarot reading flow - VERIFIED by running /tarot
- SKILL-02: Skill spawns tarot-reader subagent - VERIFIED by context: fork behavior
- SKILL-03: Skill handles random card selection - VERIFIED by shuf -i 0-21 output
</success_criteria>

<output>
After completion, create `.planning/phases/01-skill-infrastructure/01-01-SUMMARY.md`
</output>
